<!--
  HTML de documentación.
  Aplicación web de sistema tokenizador.
  Proyecto Lovelace.
-->

<div
  class="seccion"
  flex="none"
  layout="column">

  <h3>Cómo utilizar la API web</h3>

  <p>
    La API permite realizar tres operaciones que se explican a continuación;
    todas las operaciones se deben realizar mediante peticiones HTTP utilizando
    el método POST. Todas las peticiones deben tener los encabezados de tipo de
    contenido (especificando que se está enviando un JSON) y el encabezado de
    autenticación básica (siguiendo el formato dado en el RFC). En el cuerpo de
    la petición se especifica el método y el PAN o el método y el token.
  </p>

  <h4>Tokenización</h4>
  <p>
    Permite, a partir del número de una tarjeta, obtener un token asociado a
    él. El cliente debe encontrarse en estado <b>aprobado</b> o <b>en cambio de
    llaves</b>; en todos los casos, la llave que se utilizará al tokenizar
    siempre será la que tenga estado <b>actual</b>.
  </p>

  <h5> Uso y ejemplo </h5>
  <p>
    En el cuerpo de la petición se debe señalar el <b>PAN</b> y el
    <b>método</b>, siguiendo el siguiente esquema:
    <code>
      POST /programa_tokenizador/tokenizar HTTP/1.1 <br />
      { <br />
        Authorization: Basic QWxhZgRpbjpPcGVuU2VYW11 <br />
        Content-Type: Application/JSON <br />
      } <br />
      { <br />
        "pan" : "28045869693113314", <br />
        "metodo" : "FFX" <br />
      }
    </code>
    Los valores para el campo método son: FFX, BPS, TKR, AHR o DRBG.
  </p>

  <h5> Errores </h5>
  <p>
    A continuación se listan los errores que pueden surgir al tokenizar un PAN.
    <dl>
      <dt><code>
          401 - Es necesario proveer credenciales para realizar esta operación
      </code></dt>
        <dd>
          Este error surge cuando el encabezado de autenticación no se ha
          encontrado.
        </dd>
      <dt><code>
          401 - Las credenciales son incorrectas
      </code></dt>
        <dd>
          Este error surge cuando las credenciales especificadas en el
          encabezado no se encuentran registradas en el sistema.
        </dd>
      <dt><code>
          403 - El usuario no tiene los privilegios para esta operación
      </code></dt>
        <dd>
          Aunque el usuario está registrado, no tiene los permisos necesarios
          para realizar esta operación.
        </dd>
      <dt><code>
          403 - EL usuario no se encuentra en el estado necesario para esta
          operación.
      </code></dt>
        <dd>
          Aunque el usuario está registrado, no se encuentra en el estado
          requerido (<code>aprobado</code> o <code>en cambio de llaves</code>)
          para realizar esta operación.
        </dd>
      <dt><code>
          403 - Ya existe un token asociado a este PAN
      </code></dt>
        <dd>
          El usuario ya tiene un token asociado al PAN que se quiere tokenizar,
          y, por regla, solo se puede tener uno.
        </dd>
      <dt><code>
          403 - Parámetros incompletos o incorrectos
      </code></dt>
        <dd>
          El servidor no pudo encontrar el parámetro <b>pan</b>,
          <code>metodo</code> o ambos.
        </dd>
    </dl>
  </p>

</div>
