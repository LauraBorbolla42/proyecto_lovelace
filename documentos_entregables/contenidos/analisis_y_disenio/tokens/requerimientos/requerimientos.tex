%
% Requerimientos de tokens, análisis y diseño de generación de tokens.
% Proyecto Lovelace.
%

\subsection{Requerimientos}

En \cite{pci_tokens}, el \gls{gl:pci} \gls{gl:ssc} divide a los
\glspl{gl:token} en reversibles e irreversibles. A su vez, los reversibles se
dividen en criptográficos y en no criptográficos; mientras que los
irreversibles se dividen en autenticables y no autenticables (figura
\ref{fig:division_tokens}).

\begin{figure}[H]
  \begin{center}
    \includegraphics[width=0.75\linewidth]
      {contenidos/analisis_y_disenio/tokens/requerimientos/diagramas/clasificacion.png}
    \caption{Clasificación de los \glspl{gl:token}.}
    \label{fig:division_tokens}
  \end{center}
\end{figure}

En esta sección se explica cada una de las categorías y se analizan los
requerimientos que deben tener. Para comenzar, se enlistan los requerimientos
aplicables a todos los \glspl{gl:token}, sin importar en qué categoría estén:

% GT1 Es específico a productos de hardware.
% GT2 se lo chutaron.
% GT3 Validación FIPS que debe cumplir el software; fuera de alcance.

% GT4
\requerimiento{Resistencia a texto claro conocido}
{
  Un atacante con acceso a múltiples pares de \glspl{gl:token} y
  \gls{gl:pan} no debe de ser capaz de determinar otros \gls{gl:pan} a partir
  de solamente \glspl{gl:token}. En otras palabras, los \glspl{gl:token}
  deben ser resistentes a ataques con texto en claro conocido (sección
  \ref{sec:criptoanalisis}).
}

% GT5
% Me parece que esto es reduntante: si GT4 ya estableció la necesidad de
% resistencia a texto claro conocido, la resistencia a sólo texto cifrado
% ya va incluida. De hecho, en la misma redacción de GT5 incluyen claramente
% a GT4 con una disyunción.
% Creo que ya había leído esto mismo en alguno de los artículos que nos pasó
% Sandra.
\requerimiento{Resistencia a sólo texto cifrado}
{
  Recuperar un \gls{gl:pan} a partir de un \gls{gl:token} debe de ser
  \gls{gl:computacionalmente_no_factible} (resistencia a ataques con sólo
  texto cifrado, sección \ref{sec:criptoanalisis}).
}

% GT6
% ¿Requerimiento de API web?
\requerimiento{Detección de anomalías}
{
  Se deben de implementar disparadores que permitan detectar
  irregularidades en el sistema (anomalías, funcionamientos erróneos,
  comportamientos sospechosos). El producto debe registrar dichos eventos y
  avisar al personal correspondiente.
}

% GT7
\requerimiento{Distinción entre \glspl{gl:token} y \gls{gl:pan}}
{
  Se debe contar con un mecanismo para distinguir entre \glspl{gl:token}
  y \gls{gl:pan}. Los proveedores del servicio de tokenización deben
  compartir este mecanismo con la entidad (o entidades) que usa los
  \glspl{gl:token}.
}

% GT8 Guía de instalación; fuera de alcance. ¿Documentación de API web?
% de cualquier forma, es requerimiento de api web.
% GT9 Integridad de ejecutables; fuera de alcance.
% GT10 Autenticación de usuarios; requerimiento de api web.

% GT11
\requerimiento{Mapeos de \gls{gl:token} a \gls{gl:token} prohibidos}
{
  No se debe poder pasar de un primer \gls{gl:token} válido a un segundo,
  también válido; forzosamente debe existir un estado intermedio: del primer
  \gls{gl:token} se pasa al \gls{gl:pan} correspondiente (operación de
  detokenización) y de este se pasa al segundo \gls{gl:token}.
}

% GT12
\requerimiento{Protección contra vulnerabilidades comunes}
{
  Se deben implementar medidas en contra de las vulnerabilidades de
  seguridad más comunes (\cite{dss_pa}, requerimiento 5.2). Algunas de estas
  medidas pueden ser el uso de herramientas de análisis de código estático,
  o el uso de lenguajes de programación especializados.
}

% GT13 Primitivas criptográficas usadas
% También se habla sobre un documento de validación estadísitca; fuera de
% alcance.
\requerimiento{Primitivas criptográficas usadas}
{
  Las primitivas criptográficas que se usen deben estar basadas en
  estándares nacionales (Estados Unidos) o internacionales (e. g.
  \gls{gl:aes}).

  Esta es una prueba de un segundo párrafo agrgado a la definición de un requerimiento;
  la idea es que conserve la identación de las líneas anteriores.
}

Los \glspl{gl:token} irreversibles no pueden, bajo ninguna circunstancia, ser
reconvertidos al \gls{gl:pan} original. Esta restricción aplica tanto para
cualquier entidad en el entorno del negocio (comerciante, proveedor de
\glspl{gl:token}, banco) como para cualquier posible atacante. Dados un
\gls{gl:pan} y un \gls{gl:token}, los identificables permiten validar cuando el
primero fue utilizado para la creación del segundo, mientras que los no
identificables, no.

% TODO: ¿Para qué demonios sirven los no identificables?

% TODO: este párrafo me está dando problemas. No quiero copiar tal cuál la
% clasificación del PCI sin manifestar disconformidad, pero tampoco quiero
% entrar en demasiados detalles aún sobre las propias implementaciones
% (las cuales, evidentemente, sí son criptográficas); PD: hay que citar más
% publicaciones, a parte de la de Sandra.

La clasificación del \gls{gl:pci} \gls{gl:ssc} con respecto a los reversibles
resulta un poco confusa (esto ya ha sido señalado antes, \cite{doc_sandra}).
Establece que los criptográficos son generados utilizando
\gls{gl:criptografia_fuerte}, el \gls{gl:pan} nunca se almacena, solamente se
guarda una llave; los no criptográficos guardan la relación entre
\glspl{gl:token} y \gls{gl:pan} en una base de datos. El problema está en que
no se menciona \textit{cómo} generar los no criptográficos. A pesar del nombre,
los métodos más comunes para esta categoría ocupan primitivas criptográficas
(e. g. generadores pseudoaleatorios); además de que, en una implementación
real, para poder cumplir con el \gls{gl:pci} \gls{gl:dss}, la propia base de
datos debe de estar cifrada \cite{pci_dss}.

\input{contenidos/analisis_y_disenio/tokens/requerimientos/irreversibles.tex}
\input{contenidos/analisis_y_disenio/tokens/requerimientos/criptograficos_reversibles.tex}
\input{contenidos/analisis_y_disenio/tokens/requerimientos/no_criptograficos_reversibles.tex}
\input{contenidos/analisis_y_disenio/tokens/requerimientos/primitivas.tex}
