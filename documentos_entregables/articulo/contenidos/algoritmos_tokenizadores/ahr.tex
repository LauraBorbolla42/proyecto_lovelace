%
% Sección de FFX.
% Artículo.
% Proyecto Lovelace.
%

\subsection{AHR (Algoritmo híbrido reversible)}

En 2017, Longo, Aragona y Sala~\cite{aragona} propusieron un algoritmo que
denominaron \textit{híbrido reversible} que está basado en un cifrador por
bloques y ocupa una base de datos para almacenar las relaciones entre número
de tarjeta y token. En el siguiente pseudocódigo se describe el
funcionamiento general.

% Dijkstra se está retorciendo en su tumba por estos goto.

\begin{algorithm}
  \caption{\label{cod_ahr} Algoritmo híbrido reversible.}
  \begin{algorithmic}[1]
    \Function{AHR}{$ p, u, k $}
      \State $ t = f(u, p) || [\bar{p}]^s_b $
      \State $ c = E(k, t) $
      \If{$ (\bar{c} \mod 2^n) \geq 10^l $}
        \State $ t = c $
        \State Regresar a 3.
      \EndIf
      \State $ token = {[\bar{c} \mod 2^n]}^l_{10} $
      \If{\Call{comprobar}{$ token $}}
        \State $ u = u + 1 $
        \State Regresar a 2.
      \EndIf
      \State \Return{$ token $}
    \EndFunction
  \end{algorithmic}
\end{algorithm}

Al igual que con TKR, la clasificación del PCI para este algoritmo resulta
contradictoria: reversible no criptográfico; con la clasificación propuesta
en este trabajo, se convierte en un algoritmo criptográfico irreversible.
