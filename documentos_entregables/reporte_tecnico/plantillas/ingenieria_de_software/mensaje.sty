%
% Plantilla para definición de un mensaje.
% Proyecto Lovelace.
%
% TODO:
% El argumento de «nopagebreak», para ser totalmente efectivo,
% debería ser 4; cuando es cuatro se vuelve loco en algunas páginas
% y termina saliendose del márgen inferior. Tal vez es por los
% saltos tan grandes de floats de las interfaces de usuario.
%

% Contador
\newcounter{contador_de_mensajes}[chapter]

% Comando para reglas de negocio
% #1 -> Etiqueta (opcional).
% #2 -> Título de mensaje
% #3 -> Contenido.

\newcommand{\mensaje}[3]
[msj:\formatearnumero{contador_de_mensajes}]
{
  % Configuración
  \refstepcounter{contador_de_mensajes}
  \setlength{\separacionAnterior}{\parskip}
  \setlength{\parskip}{0em}

  % Código efectivo
  \vspace{1.0em}
  \noindent
  \textbf{\hypertarget{#1}
    {MSJ\prefijo-\formatearnumero{contador_de_mensajes} #2}.}
  \par
  \nopagebreak[3]
  \begin{hangparas}{2em}{0}
    #3
  \end{hangparas}

  % Estado previo
  \setlength{\parskip}{\separacionAnterior}
}
