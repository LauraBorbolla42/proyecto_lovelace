%
% Lista de requerimientos funcionales,
% Capítulo de análisis y diseño de api web.
% Proyecto Lovelace
%

\subsubsection{Funcionales}
\vspace{-4.0em}

\requerimiento[rq:gestionar_sesion]
{Gestionar sesión}
{
  La aplicación web debe permitir a los usuarios \textbf{cliente} y
  \textbf{administrador} iniciar y cerrar sesión. Deben proporcionar los
  siguientes datos para iniciar sesión:
  \begin{itemize}
    \item Correo electrónico
    \item Contraseña
  \end{itemize}
}

\requerimiento[rq:validar_credenciales_iniciar_sesion]
{Validar credenciales al iniciar sesión}
{
  La contraseña introducida debe coincidir con el correo ingresado.
}

\requerimiento[rq:validar_clientes_iniciar_sesion]
{Validar estado de clientes al iniciar sesión}
{
  Aquellos \textbf{clientes} que se encuentren en alguno de los siguientes
  estados no deben poder iniciar sesión: \textbf{en espera},
  \textbf{rechazado} o \textbf{en lista negra}.
}

\requerimiento[rq:validar_correo_iniciar_sesion]
{Validar estado de correo al iniciar sesión}
{
  El correo del cliente debe encontrarse en estado \textbf{válido}.
}

\requerimiento[rq:registrar_cliente]
{Registrar cliente}
{
  La aplicación web debe permitir a los usuarios  de tipo \textbf{visitante}
  registrarse; el visitante debe proporcionar los siguientes datos:
  \begin{itemize}
    \item Correo electrónico válido
    \item Contraseña
    \item Confirmación de contraseña
  \end{itemize}
}

\requerimiento[rq:verificar_cliente]
{Verificar cliente}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{cliente}
  verificar su correo mediante un enlace enviado al registrarse.
}

\requerimiento[rq:verificar_nuevo_correo]
{Verificar nuevo correo}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{cliente}
  verificar su nuevo correo mediante un enlace enviado al terminar de editar
  sus datos.
}

\requerimiento[rq:aprobar_cliente]
{Aprobar cliente}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{administrador}
  aprobar y rechazar usuarios de tipo \textbf{cliente}.
}

\requerimiento[rq:mostrar_clientes_en_espera]
{Mostrar clientes en espera}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{administrador}
  consultar la lista de \textbf{clientes} en estado \textbf{en espera} con
  correo \textbf{verificado}.
}

\requerimiento[rq:mostrar_clientes_aprobados]
{Mostrar clientes aprobados}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{administrador}
  consultar la lista de \textbf{clientes} en estado \textbf{aprobado}.
}

\requerimiento[rq:mostrar_clientes_vetados]
{Mostrar clientes en lista negra}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{administrador}
  consultar la lista de \textbf{clientes} en estado \textbf{en lista negra}.
}

\requerimiento[rq:administrar_vetados]
{Administrar lista negra}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{administrador}
  poner y quitar a un \textbf{cliente} de la lista negra.
}

\requerimiento[rq:desvetar_cliente]
{Quitar cliente de lista negra}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{administrador}
  quitar a un \textbf{cliente} de la lista negra.
}

\requerimiento[rq:actualizar_cliente]
{Actualizar datos de cliente}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{cliente}
  actualizar sus datos (correo electrónico y contraseña).
}

\requerimiento[rq:eliminar_cliente]
{Eliminar datos de un cliente}
{
  La aplicación web debe permitir a un usuario de tipo \textbf{cliente} eliminar
  su cuenta y datos del sistema.
}

\requerimiento[rq:administrar_refresco_de_llaves]
{Administrar refresco de llaves}
{
  La aplicación web debe permitir, a un \textbf{cliente}, iniciar o terminar el
  refresco de sus llaves.
}

\requerimiento[rq:recordatorio_refresco]
{Recordatorio de refresco de llaves}
{
  El sistema debe mostrar un aviso en la página de inicio de un \textbf{cliente}
  y enviar una notificación diaria a los clientes que tengan llaves cuyo
  criptoperiodo haya caducado.
}

\requerimiento[rq:tokenizar_tarjeta]
{Tokenizar número de tarjeta}
{
  La aplicación web debe permitir, a una \textbf{aplicación cliente}, realizar
  la tokenización de un número de tarjeta. La aplicación cliente debe
  proporcionar los siguientes datos:
  \begin{itemize}
    \item Número de tarjeta a tokenizar.
    \item Algoritmo tokenizador.
    \item Credenciales.
  \end{itemize}

  \begin{hangparas}{2em}{0}
    La operación regresa un token.

    \subrequerimiento[rq:validar_clientes_tokenizar]
    {Validar estado de clientes al tokenizar}
    {
      Para realizar una operación de tokenización, el \textbf{cliente} asociado a
      la \textbf{aplicación cliente} debe encontrarse en estado \textbf{aceptado}
      o \textbf{en cambio de llaves}.
    }
  \end{hangparas}
}

\requerimiento[rq:detokenizar_token]
{Detokenizar token}
{
  La aplicación web debe permitir, a una \textbf{aplicación cliente}, realizar
  la detokenización de un token. La aplicación cliente debe proporcionar los
  siguientes datos:
  \begin{itemize}
    \item Token.
    \item Algoritmo tokenizador.
    \item Credenciales.
    \item \texttt{[Opcional]} Versión de llaves a utilizar.
  \end{itemize}

  \begin{hangparas}{2em}{0}
    La operación regresa un número de tarjeta.

    \subrequerimiento[rq:validar_clientes_detokenizar]
    {Validar estado de clientes al detokenizar}
    {
      Para realizar una operación de detokenización, el \textbf{cliente} asociado
      a la \textbf{aplicación cliente} debe encontrarse en estado
      \textbf{aceptado} o \textbf{en cambio de llaves}.
    }
  \end{hangparas}
}

\requerimiento[rq:retokenizar_token]
{Retokenizar token}
{
  La aplicación web debe permitir, a una \textbf{aplicación cliente} cuyo
  \textbf{cliente} ha iniciado el refresco de llaves, realizar la retokenización
  de un token. La aplicación cliente debe proporcionar los siguientes datos:
  \begin{itemize}
    \item Token.
    \item Algoritmo tokenizador.
    \item Credenciales.
  \end{itemize}

  \begin{hangparas}{2em}{0}
    La operación regresa el token actualizado.

    \subrequerimiento[rq:validar_clientes_retokenizar]
    {Validar estado de clientes al retokenizar}
    {
      Para realizar una operación de retokenización, el \textbf{cliente} asociado
      a la \textbf{aplicación cliente} debe encontrarse en estado \textbf{en
      cambio de llaves}.
    }
  \end{hangparas}
}

\requerimiento[rq:algoritmos_para_tokenizar]
{Algoritmos para tokenizar}
{
  Las operaciones de tokenización, detokenización y retokenización
  (especificadas en \hipervinculo{rq:tokenizar_tarjeta},
  \hipervinculo{rq:detokenizar_token} y \hipervinculo{rq:retokenizar_token}
  respectivamente) deben especificar el algoritmo tokenizador con el que se
  realizará la operación. Los algoritmos disponibles son:
  \begin{itemize}
    \item BPS
    \item FFX
    \item TKR
    \item AHR
    \item DRBG
  \end{itemize}
}

\requerimiento[rq:mostrar_documentacion]
{Mostrar documentación del servicio tokenizador}
{
  La aplicación web debe tener una página donde se muestre la documentación de
  la API.
}

\requerimiento[rq:mostrar_promocion]
{Mostrar promoción del servicio tokenizador}
{
  La aplicación web debe tener una página que promocione el servicio de
  tokenización, esta página también debe explicar qué es la tokenización, qué es
  un servicio de tokenización y cómo funcionan los algoritmos implementados.
}

\requerimiento[rq:notificar_envio_correo]
{Notificar cliente}
{
  La aplicación web debe notificar a un \textbf{cliente} siempre que le envíe
  un correo de verificación.
}

% Otros

\requerimiento[rq:notificar_cambio_administrador]
{Notificar cliente por correo electrónico}
{
  La aplicación web debe notificar por correo electrónico a un \textbf{cliente}
  siempre que un \textbf{administrador} cambie su estado.
}

\requerimiento[rq:confirmar_cliente]
{Confirmación de un cliente}
{
  La aplicación web debe pedir la confirmación del \textbf{cliente} siempre que
  quiera realizar una de las siguientes acciones:
  \begin{itemize}
    \item Eliminar su cuenta.
    \item Terminar refresco de llaves con tokens en estado \textbf{anterior}.
  \end{itemize}
}

\requerimiento[rq:confirmar_administrador]
{Confirmación de un administrador}
{
  La aplicación web debe pedir la confirmación del \textbf{administrador}
  siempre que quiera realizar una de las siguientes acciones:
  \begin{itemize}
    \item Rechazar a un cliente.
    \item Vetar a un cliente.
    \item Terminar refresco de llaves con tokens en estado \textbf{anterior}.
  \end{itemize}
}

\requerimiento[rq:estados_cliente]
{Cambiar estado de un cliente}
{
  La aplicación web debe permitir cambiar el estado de un \textbf{cliente}:
  \begin{itemize}
    \item \textbf{en espera}
    \item \textbf{aprobado}
    \item \textbf{rechazado}
    \item \textbf{en cambio de llaves}
    \item \textbf{en lista negra}
  \end{itemize}
}

\requerimiento[rq:estados_token]
{Cambiar estado de un token}
{
  La aplicación web debe permitir cambiar el estado de un token:
  \begin{itemize}
    \item \textbf{actual}
    \item \textbf{anterior}
    \item \textbf{retokenizado}
  \end{itemize}
}

\requerimiento[rq:estados_llave]
{Cambiar estado de una llave}
{
  La aplicación web debe permitir cambiar el estado de una llave:
  \begin{itemize}
    \item \textbf{actual}
    \item \textbf{anterior}
  \end{itemize}
}

\requerimiento[rq:estados_correo]
{Cambiar estado de un correo}
{
  La aplicación web debe permitir cambiar el estado de un correo:
  \begin{itemize}
    \item \textbf{verificado}
    \item \textbf{no verificado}
  \end{itemize}
}
