%
% Explicación de código de BPS, reporte técnico.
%
% Proyecto Lovelace.
%

%
\subsection{Módulo de BPS}

El funcionamiento de \gls{gl:bps} se describe de forma más amplia en la sección
\ref{sec:bps}.

% ¿Que no está ya se dijo en el diseño?
% Bueno, tampoco está mal repetirlo.

A pesar de que se puede ver a \gls{gl:bps} como una versión más especifica de
\gls{gl:ffx}, esta implementación se hizo independiente de la de \gls{gl:ffx}.

De forma general, el módulo de \gls{gl:bps} consta de los 2 métodos principales,
el de cifrar y el de descifrar, los cuales son la implementación del modo de
operación utilizado por \gls{gl:bps} y que se describe en la sección
\ref{sec:bps_modo_operacion}. Estos métodos se muestran en los códigos
\ref{codigo:bps_cifrado_1},~\ref{codigo:bps_cifrado_2},
\ref{codigo:bps_descifrado_1} y~\ref{codigo:bps_descifrado_2}.

\codigoFuente[codigo:bps_cifrado_1]{77}{116}{c++}{%
  implementaciones/bps/cifrador_BPS.cpp}{%
  Función de cifrado de \gls{gl:bps} (parte 1).}

\codigoFuente[codigo:bps_cifrado_2]{116}{156}{c++}{%
  implementaciones/bps/cifrador_BPS.cpp}{%
  Función de cifrado de \gls{gl:bps} (parte 2).}

\codigoFuente[codigo:bps_descifrado_1]{158}{198}{c++}{%
  implementaciones/bps/cifrador_BPS.cpp}{%
  Función de descifrado de \gls{gl:bps} (parte 1).}

\codigoFuente[codigo:bps_descifrado_2]{198}{250}{c++}{%
  implementaciones/bps/cifrador_BPS.cpp}{%
  Función de descifrado de \gls{gl:bps} (parte 2).}

Otro parte crucial de \gls{gl:bps} es el cifrado interno BC, por lo cual es
importante mostrar su implementación. Los códigos~\ref{codigo:bps_cifrador_bc_1}
y~\ref{codigo:bps_cifrador_bc_2} están basados en el pseudocódigo para el
cifrado BC descrito en~\ref{sec:bps_cifrador_interno_bc}.

\codigoFuente[codigo:bps_cifrador_bc_1]{111}{165}{c++}{%
  implementaciones/bps/cifrador_BC.cpp}{%
  Cifrado interno BC de  \gls{gl:bps} (parte 1).}

\codigoFuente[codigo:bps_cifrador_bc_2]{165}{218}{c++}{%
  implementaciones/bps/cifrador_BC.cpp}{%
  Cifrado interno BC de  \gls{gl:bps} (parte 2).}

Como se observa en el código~\ref{codigo:bps_cifrador_bc_2}, el cifrado
interno usa a su vez un cifrado de ronda, que es un cifrado por bloques
(en este caso \gls{gl:aes} o \gls{gl:des}), el cual se hizo usando la
librería de Crypto++.
