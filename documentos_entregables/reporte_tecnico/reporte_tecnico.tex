%
% Archivo principal de documento final.
% Proyecto Lovelace.
%

\documentclass[11pt, letterpaper, twosides]{book}
\usepackage{formato}
\newcommand{\Titulo}{Generación de \textit{tokens} para proteger
                     los datos de tarjetas bancarias}
\newcommand{\Fecha}{Enero de 2018}
\usepackage{reporte_tecnico/formato}

\begin{document}

  \frontmatter
  \Portada

  \pdfbookmark[1]{\contentsname}{Contenido}
  \setcounter{page}{3}
  \setcounter{tocdepth}{2}
  \tableofcontents
  \setcounter{tocdepth}{5}
  \newpage

  \import{reporte_tecnico/contenidos/}{simbologia.tex}

  \mainmatter
  \import{reporte_tecnico/contenidos/intro/}{intro.tex}
  \import{reporte_tecnico/contenidos/marco_teorico/}{marco_teorico.tex}

  \part{Generación de tokens}
  \import{reporte_tecnico/contenidos/generacion_tokens/}{generacion_tokens.tex}
  \import{reporte_tecnico/contenidos/analisis_y_disenio_tokens/}
    {analisis_y_disenio.tex}
  \import{reporte_tecnico/contenidos/implementacion_tokens/}
    {implementacion.tex}

  \part{Interfaz en red}
  \import{reporte_tecnico/contenidos/analisis_y_disenio_api_web/}
    {analisis_y_disenio.tex}
  \import{reporte_tecnico/contenidos/implementacion_api_web/}
    {implementacion.tex}

  \part{Caso de prueba: tienda en línea}
  \chapter{Análisis y diseño}
  \chapter{Implementación}

  % Coloca a las conclusiones afuera de cualquier parte
  \bookmarksetup{startatroot}
  \import{reporte_tecnico/contenidos/conclusiones/}{conclusiones.tex}
  \import{reporte_tecnico/contenidos/apendices/}{apendices.tex}

  % Nuevo formato de capítulos
  \titleformat{\chapter}[display]
  {\bfseries\Huge\centering}                  % Formato
  {\thechapter}                               % Etiqueta
  {0.5ex}                                     % Separación
  {}                                          % Antes de
  []                                          % Después de

  \renewcommand{\capitulo}[3]
  {
    \chapter*{#1}
    \label{#2}
    #3
    \newpage
  }

  % Coloca glosarios afuera de los apéndices
  \bookmarksetup{startatroot}

  \setglossarystyle{altlist}
  \printglossary[
    type=main,
    entrycounter=true
  ]

  \phantomsection
  \addcontentsline{toc}{chapter}{Siglas y acrónimos}
  \capitulo{Siglas y acrónimos}{sec:siglas}
  {
    \epigrafe
    {%
      Por supuesto que la paz es el respeto al derecho ajeno, en eso todos
      estamos de acuerdo. En lo que nadie está de acuerdo es en cuál es el
      derecho ajeno.%
    }
    {%
      Instrucciones para vivir en México,
      \textsc{Jorge Ibargüengoitia}.%
    }
  }

  \setglossarystyle{list}
  \renewcommand*{\glsgroupskip}{}

  \printglossary[
    type=siglas_cripto,
    title={Criptográficos}
  ]

  \printglossary[
    type=siglas_computacionales,
    title={Computacionales}
  ]

  \printglossary[
    type=siglas_bancarias,
    title={Bancarios}
  ]

  \printglossary[
    type=siglas_instituciones,
    title={De instituciones y asociaciones}
  ]

  %\printglossary[
  %  type=\acronymtype,
  %  title={Misceláneos}
  %]

  \phantomsection
  \addcontentsline{toc}{chapter}{Bibliografía}
  \capitulo{Bibliografía}{sec:referencias}
  {
    \epigrafe
    {%
      Those who believe in telekinetics, raise my hand.%
    }
    {%
      \textsc{Kurt Vonnegut}.%
    }
  }
  \printbibliography[
    heading=none,
    title={Bibliografía}
  ]

  \newpage
  \phantomsection
  \addcontentsline{toc}{chapter}{\listfigurename}
  \listoffigures

  \newpage
  \phantomsection
  \addcontentsline{toc}{chapter}{\listtablename}
  \listoftables

  \newpage
  \phantomsection
  \addcontentsline{toc}{chapter}{\lstlistlistingname}
  \lstlistoflistings

  %\newpage
  %\phantomsection
  %\addcontentsline{toc}{chapter}{\listoflistingscaption}
  %\listoflistings

\end{document}
