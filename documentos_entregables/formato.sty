%
% Especificación de formato y plantillas para documento final.
% Proyecto Lovelace.
%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{formato}[2017/10/13 Paquete para formato de documento de TT]

% Dependencias de librerías.

% http://mirrors.ctan.org/macros/latex/required/graphics/grfguide.pdf
\RequirePackage{graphicx}

% http://mirrors.ctan.org/macros/latex/contrib/float/float.pdf
\RequirePackage{float}

% http://mirrors.ctan.org/macros/latex/contrib/fancyhdr/fancyhdr.pdf
\RequirePackage{fancyhdr}

% http://mirrors.ctan.org/macros/latex/contrib/xcolor/xcolor.pdf
\RequirePackage{xcolor}

% http://mirrors.ctan.org/macros/latex/contrib/titlesec/titlesec.pdf
\RequirePackage{titlesec}

% http://mirrors.ctan.org/macros/latex/required/amsmath/amsmath.pdf
\RequirePackage{amsmath}

% http://mirrors.ctan.org/macros/latex/contrib/lastpage/lastpage.pdf
\RequirePackage{lastpage}

% http://mirrors.ctan.org/macros/latex/contrib/caption/caption-eng.pdf
\RequirePackage{caption}

% http://mirrors.ctan.org/macros/latex/contrib/caption/subcaption.pdf
\RequirePackage{subcaption}

% http://mirrors.ctan.org/macros/latex/contrib/hyperref/doc/manual.pdf
\RequirePackage{hyperref}
\hypersetup
{
  pdftitle={\Titulo},
  pdfsubject={\Subtitulo},
  bookmarksnumbered=true,
  bookmarksopen=true,
  bookmarksopenlevel=1,
  pdfstartview=Fit,
  pdfpagemode=UseOutlines,
  colorlinks,
  linkcolor={black},
  citecolor={black},
  urlcolor={black},
  pagebackref=true
}

% http://mirrors.ctan.org/macros/latex/contrib/oberdiek/bookmark.pdf
\RequirePackage{bookmark}

% http://mirrors.ctan.org/macros/latex/contrib/listings/listings.pdf
\RequirePackage{listings}

% http://mirrors.ctan.org/macros/latex/contrib/glossaries/glossariesbegin.pdf
\RequirePackage[acronym, toc]{glossaries}

% http://mirrors.ctan.org/fonts/amsfonts/doc/amsfndoc.pdf
\RequirePackage{amsfonts}

% http://mirrors.ctan.org/fonts/amsfonts/doc/amsfndoc.pdf
\RequirePackage{array}

% http://mirrors.ctan.org/macros/latex/contrib/makecell/makecell.pdf
\RequirePackage{makecell}

% http://mirrors.ctan.org/macros/latex/contrib/changepage/changepage.pdf
\RequirePackage{changepage}

% http://mirrors.ctan.org/macros/latex/contrib/hanging/hanging.pdf
\RequirePackage{hanging}                    % Indentación personalizada.

% http://mirrors.ctan.org/biblio/bibtex/base/btxdoc.pdf
\RequirePackage[backend=biber,              % Estilo Biblatex
                style=numeric,              % Etiquetas numéricas
                sorting=none,               % Ordenado según aparición
                citestyle=ieee              % Tipo ieee
                ]{biblatex}                 % Referencias

% http://mirrors.ctan.org/macros/latex/contrib/geometry/geometry.pdf
\RequirePackage[letterpaper,                % Tamaño
                textwidth=7in,              % Ancho
                textheight=9.0in,           % Alto
                top=1.0in,
                bindingoffset=6mm
                ]{geometry}                 % Márgenes

% Nota sobre geometry:
% Un binding offset de 6mm parece dejar los márgenes iguales para
% páginas pares e impares (no lo entiendo, simplemente me lo dijo
% tex.stackexchange), creo que ya que vayamos a imprimir es una buena idea
% leer la documentación
% http://texdoc.net/texmf-dist/doc/latex/geometry/geometry.pdf

% Formato de párrafos
\setlength{\parindent}{2em}                 % Sangría
\setlength{\parskip}{1em}                   % Espacio entre párrafos
\renewcommand{\baselinestretch}{1.25}       % Interlineado

% Formato de títulos
\titleformat{\chapter}[display]
{\bfseries\Huge\centering}                  % Formato
{Capítulo \ \thechapter}                    % Etiqueta
{0.5ex}                                     % Separación
{}                                          % Antes de
[\newpage]                                  % Después de

% izquierda, arriba, abajo
\titlespacing*{\section}{0pc}{0pc}{0pc}
\titlespacing*{\subsection}{0pc}{1pc}{0pc}
\titlespacing*{\subsubsection}{0pc}{1pc}{0pc}

% Secciones en nueva página
\newcommand{\sectionbreak}{\clearpage}

% Espaciado en floats H (arriba y abajo)
\setlength{\intextsep}{1em}                 % Con H
\setlength{\textfloatsep}{1em}              % Con T y B
% https://tex.stackexchange.com/questions/36361/how-can-i-inject-the-proper-
% amount-of-vertical-space-between-captions-and-figure/36362#comment72508_36362

% Encabezado y pie
% Parámetros de fancyhead y fancyfoot:
% C (center), L (left), R (right)
% E (even), O (odd)
\pagestyle{fancy}
\fancyhf{}
\fancyhead[CE,CO]{\Titulo}                  % Centro arriba
\fancyfoot[RE, LO]{Página \thepage \
   de \pageref{LastPage}}                   % Derecha abajo
\fancyfoot[LE, RO]{\nouppercase\leftmark}   % Izquierda abajo
\renewcommand{\headrulewidth}{0.5pt}        % Línea encabezado
\renewcommand{\footrulewidth}{0.5pt}        % Línea pie

% El entorno «plain» es el que utilizan las página de los capítulos
% Se redefine para que no tengan ni pie ni encabezado.
\fancypagestyle{plain} {
  \fancyfoot[LE, RO]{}
  \fancyfoot[LO, RE]{}
  \fancyhead[CE, CO]{}
  \renewcommand{\headrulewidth}{0.0pt}
  \renewcommand{\footrulewidth}{0.0pt}
}

% Cambios en las traducciones de babel
\addto\captionsspanish
{
  \renewcommand*\contentsname{Contenido}
  \renewcommand*\listfigurename{Lista de figuras}
  \renewcommand*\tablename{Tabla}
  \renewcommand*\listtablename{Lista de tablas}
  \renewcommand*{\lstlistlistingname}{Lista de pseudocódigos}
}

% Información de latex
\title{\Titulo{}}
\author{\Autor{}}
\date{\today}

% Archivos de plantillas
\input{plantillas/formato_numeros.sty}
\input{plantillas/portada.sty}
\input{plantillas/pseudocodigo.sty}
\input{plantillas/requerimiento.sty}

% Archivo con entradas del glosario
\input{contenidos/glosario.tex}

% Archivo con definición de siglas
\input{contenidos/siglas.tex}

% Archivo con referencias
\addbibresource{contenidos/referencias.bib}

% Redefinición de listas y de bibliografía.
% Se hacen secciones en lugar de capítulos.

\makeatletter
\renewcommand\listoffigures{
  \section*{\listfigurename}
    \@mkboth{\MakeUppercase\listfigurename}
            {\MakeUppercase\listfigurename}
  \@starttoc{lof}
}
\renewcommand\listoftables{
  \section*{\listtablename}
    \@mkboth{\MakeUppercase\listtablename}
            {\MakeUppercase\listtablename}
  \@starttoc{lot}
}
\renewcommand\lstlistoflistings{
  \section*{\lstlistlistingname}
    \@mkboth{\MakeUppercase\lstlistlistingname}
            {\MakeUppercase\lstlistlistingname}
  \@starttoc{lol}
}
\renewcommand\tableofcontents{
  \section*{\contentsname}
    \@mkboth{\MakeUppercase\contentsname}
            {\MakeUppercase\contentsname}
  \@starttoc{toc}
}
\makeatother
