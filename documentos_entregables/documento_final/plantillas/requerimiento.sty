%
% Plantilla para definición de requerimientos.
% Proyecto Lovelace.
%

% Contadores de requerimientos
\newcounter{contador_requerimientos_tokens}[chapter]
\newcounter{contador_subrequerimientos}[chapter]

% Comando para requerimientos.
% #1 -> etiqueta (opcional).
% #2 -> Título del requerimiento.
% #3 -> Descripción.
% TODO:
%   - guardar en variable temporal separación inicial entre párrafos.
%   - Prefijo según el módulo (tokens, api, tienda).
%   - Los tamaños de indentación deben tomar como base la identación de
%     todo el documento.

\newcommand{\requerimiento}[3]
[rq:\formatearnumero{contador_requerimientos_tokens}]
{
  % Configuración
  \refstepcounter{contador_requerimientos_tokens}
  \setcounter{contador_subrequerimientos}{0}
  \setlength{\parskip}{0em}

  % Código efectivo
  \vspace{1.0em}
  \noindent
  \textbf{\hypertarget{#1}
    {REQPCI-\formatearnumero{contador_requerimientos_tokens} #2}.}
  \par
  \begin{hangparas}{2em}{0}
    #3
  \end{hangparas}

  % Regresar a estado previo
  \setlength{\parskip}{1.0em}
}

% Comando para subrequerimientos.
% #1 -> etiqueta (opcional).
% #2 -> Título del subrequerimiento.
% #3 -> Descripción.
% ATENCIÓN:  Los subrequerimientos siempre deben estar dentro de la
% descripción de un requerimiento.

\newcommand{\subrequerimiento}[3]
[rq:\formatearnumero{contador_requerimientos_tokens}_%
  \arabic{contador_subrequerimientos}]
{
  % Configuración
  \refstepcounter{contador_subrequerimientos}

  % Código efectivo
  \vspace{1.0em}
  \textbf{\hypertarget{#1}
    {SUBREQPCI-\formatearnumero{contador_requerimientos_tokens}%
      /\arabic{contador_subrequerimientos} #2}.}
  \par
  \begin{hangparas}{4em}{0}
    #3
  \end{hangparas}
}
